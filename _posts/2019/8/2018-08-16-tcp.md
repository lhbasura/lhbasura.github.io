---  
layout:     post
title:      TCP的三次握手四次挥手与sync攻击
subtitle:   
date:       2019-08-16
author:     lhbasura
header-img: 
keywords_post:  "tcp"
catalog: true
tags:
    - tcp
    - 网络协议  
--- 
## 前言  
本文旨在用通俗的语言说明对TCP三次握手以及四次挥手的理解，以及为什么握手需要三次但是挥手需要四次
## 三次握手  
我们先来看一张网络上的图
![三次握手](/img/tcp_connect.png)
图中SYN和ACK只是标志位，我们不用关注，我们只需要关注syn和ack
这个过程用文字描述一下就是  
1. 客户端向服务端发送seq=J  
2. 服务端收到后向客户端发送ack=J+1,seq=K
3. 客户端向服务端回应ack=K+1 ，至此连接建立完成

看到这里你可能会觉得又是ack又是seq这些都是什么意思，别急，我们可以把这个过程翻译成人话来理解一下  

#### 建立连接的通俗理解  
建立连接后我们认为这个通讯是可靠的，通讯是可靠的说的直白一点就是  
`我能确定你能收到我的信息，你能确定我能收到你的信息`，
建立连接的过程实质上是在互相确认对方可以收到信息的过程

#### 举个🌰
我们现在用男女同学之间异地写信来模拟一下三次握手的场景（皮一下很开心） 
 
现在女生A想和男生B通信，于是写了一封信寄给男生B男生B收到女A的信后很开心很激动然后就去打了
几把游戏冷静一下😓，而生女生A把信发出去后发现一直没有回应，以为对方收不到，然后就放弃了 

所以男生B收到女生A的信后应该进行回应否则女生A是不知道你收到了信的，
后来男生B收到女生A信后终于回信，然后女生A收到信后也忘了回信，于是男生B也以为女生A收不到信，
就一直等呀等，一辈子就这么过去了（这真是个悲伤的故事🤦‍） 

所以这时候女生A也应该回信，让男生B知道她能收到信，自此以后他们就能正式开始互通信件了

#### 三次握手的本质
上面这个例子中女生A其实是客户端，男生B其实是服务端，三次握手实质上是在做下面的确认  
1. 客户端：你是否能收到我的讯息（向服务端发送seq=J）
2. 服务端：我可以收到你的信息（ack=J+1代表可以收到客户端的信息），你能否收到我的信息（向客服端发送seq=K）
3. 客户端：我可以收到你的信息（向服务端回应ack=K+1代表可以收到服务端信息)

连接建立


## 四次挥手  
先上图
![四次挥手](/img/tcp_disconnect.png)

未完待续。。。